var lookbookModule=function(){function o(){if($("#outerWrap").length>0){var o=1.3*$(window).height();if($("#outerWrap").css("maxWidth",o),-1!==window.navigator.userAgent.indexOf("MSIE")||-1!==window.navigator.userAgent.indexOf("Trident"))var e=0,r=setInterval(function(){20>e?$("#outerWrap").width()>0?($(".panel").css("width",$("#slide-panel").css("width")),$(".panel-container").css("width",parseInt($(".panel").length+1)+"00%"),e=20):e++:clearInterval(r)},100)}}var e=window[$("#jersey-outer-wrap").attr("collection")],r={},t=void 0,i=void 0,n=void 0,a=void 0,s=void 0,c=void 0;getDataStr=function(){if(e&&0!=e.length){for(var o=0;o<e.length;o++){var r=e[o].lookbookID;if(r==currentLookBookID){lookbookCodeObj=e[o];break}}var t={skuList:[]};if(null!=lookbookCodeObj)for(var o=0;o<lookbookCodeObj.products.length;o++)t.skuList.push(lookbookCodeObj.products[o].prodId);return 0==t.skuList.length?!1:JSON.stringify(t)}return!1},getLookbookStockInfo=function(o){$.ajax({url:"/services/stockservices.asmx/GetProductVariantStock",type:"POST",contentType:"application/json; charset=utf-8",data:o,dataType:"json",success:function(o){stockJson=$.parseJSON(o.d),rangeModule.setFadedOutRangeImagesBasedOnStock(),rangeModule.populateRangeSizesBasedOnStock(),rangeModule.initAddToBasket(),rangeModule.toggleOpenDescription(),reviewDisplayModule.callReviews(),"undefined"!=typeof wishlistModule.updateAddRemoveWishlistButton&&wishlistModule.updateAddRemoveWishlistButton()}})},getLookbookProductInfo=function(){var o=getDataStr();0!=o&&$.ajax({url:"/services/stockservices.asmx/GetProductData",type:"POST",contentType:"application/json; charset=utf-8",data:o,dataType:"json",success:function(e){productJson=$.parseJSON(e.d);for(var r=0;r<productJson.products.length;r++)for(prop in productJson.products[r])"title"==prop||"description"==prop||"details"==prop||"fitNotes"==prop||"provenance"==prop||"restricted"==prop||"0"!==productJson.products[r][prop][0].price&&null!==productJson.products[r][prop][0].price&&"0.00"!==productJson.products[r][prop][0].price&&"undefined"!==productJson.products[r][prop][0].price||productJson.products.splice(r,1);productJson.products.length>0&&(setUpRangeBuyOff(),rangeModule.setBaseBuyOffVars(),rangeModule.setCurrentObj(!1),rangeModule.populateRangeImages(),rangeModule.populateRangeBuyOffSection(),getLookbookStockInfo(o),$(".panel-wrapper:eq("+parseInt(currentLookBookID-1)+")").prepend("<a href='#' class='shop-button'>SHOP</a>"),setTimeout(function(){$(".shop-button").addClass("fade-me-in")},250),productJson.products.length>1?($(".MagicZoomPlus").after("<img src='//toast-images.s3.amazonaws.com/content-images/development/jersey/OurJersey_Right.png' class='jersey-carousel-right' />"),$(".MagicZoomPlus").after("<img src='//toast-images.s3.amazonaws.com/content-images/development/jersey/OurJersey_Left.png' class='jersey-carousel-left' />")):$(".jersey-carousel-left, .jersey-carousel-right").remove())}})},lookbookGoLeft=function(){$(".shop-button").fadeOut(400,function(){$(this).remove()}),1==currentLookBookID?currentLookBookID=e.length:currentLookBookID--,setSources(!1,!1),getLookbookProductInfo(),updateIndexOfLookbook(),$(".lookbook-loader").removeClass("visuallyHidden")},lookbookGoRight=function(){$(".shop-button").fadeOut(400,function(){$(this).remove()}),currentLookBookID!=e.length?currentLookBookID++:currentLookBookID=1,setSources(!1,!0),getLookbookProductInfo(),updateIndexOfLookbook(),$(".lookbook-loader").removeClass("visuallyHidden")},setSources=function(o){var l=_.find(e,function(o){return parseInt(o.lookbookID)==currentLookBookID});r.lookbookFoundItem=l,t=_.find(e,function(o){return parseInt(o.lookbookID)==currentLookBookID+1}),i=_.find(e,function(o){return parseInt(o.lookbookID)==currentLookBookID-1}),a=_.find(e,function(o){return parseInt(o.lookbookID)==currentLookBookID+2}),n=_.find(e,function(o){return parseInt(o.lookbookID)==currentLookBookID-2}),o&&(s=_.find(e,function(o){return 1==parseInt(o.lookbookID)}),c=_.find(e,function(o){return parseInt(o.lookbookID)==e.length}),s&&$($(".liquid-slider div img")[0]).attr("src",s.imgSrc),c&&$($(".liquid-slider div img")[e.length-1]).attr("src",c.imgSrc),r.lookbookFoundItem&&$($(".liquid-slider div img")[currentLookBookID-1]).attr("src",r.lookbookFoundItem.imgSrc),i&&$($(".liquid-slider div img")[currentLookBookID-2]).attr("src",i.imgSrc),t&&$($(".liquid-slider div img")[currentLookBookID]).attr("src",t.imgSrc),n&&$($(".liquid-slider div img")[currentLookBookID-3]).attr("src",n.imgSrc),a&&$($(".liquid-slider div img")[currentLookBookID+1]).attr("src",a.imgSrc))},updateIndexOfLookbook=function(){$("#imgNames").length<1&&(currentLookBookID=0==currentLookBookID?currentLookBookID=1:currentLookBookID,window.location.hash=currentLookBookID)},initialSetUp=function(){$(".jersey-buy-off, .buy-off-container").hide();var o=document.location.href.indexOf(".htm"),r=document.location.href.slice(o),t=document.location.href.slice(0,o+4);$(".lookbook-navigations .back-to-catalogue").attr("href",t),currentLookBookID=parseInt(r.slice(r.indexOf("#")+1)),_.isNaN(currentLookBookID)&&(currentLookBookID=1),updateIndexOfLookbook();for(var i=_.find(e,function(o){return parseInt(o.lookbookID)==currentLookBookID}),n=0;n<e.length;n++){var a=$('<div><img class="grid-image"></div>');$(".liquid-slider").append(a)}i&&setSources(!0)},setUpRangeBuyOff=function(){$(".jersey-buy-off .group-images-set-one").html("");for(var o=0;o<window.productJson.products.length;o++)for(prop in window.productJson.products[o])if("title"!=prop&&"description"!=prop&&"details"!=prop&&"fitNotes"!=prop&&"provenance"!=prop&&"restricted"!=prop){var e=$("<img >"),r=$('<li class="range-product" id="'+prop+'"></li>');$(".jersey-buy-off .group-images-set-one").append(r),r.append(e)}$($(".range-product")[0]).addClass("selected-range-product")};var l=_.debounce(o,300);return $(window).resize(function(){$("#imgNames").length>0&&(Modernizr.mq("(max-width: 767px)")||$(".jersey-buy-off, .buy-off-container").hide()),l()}),$(document).ready(function(){if(l(),$(".social-icons-wrapper").length>0&&($(".facebook-lookbook").click(function(o){o.preventDefault();var r=$(".currentPanel img").attr("src").replace(sizeRegex,"/250/"),t=$("head title").text()+"%20page%20"+currentLookBookID+"%20by%20TOAST";e.length>0&&void 0!=e[0].sharingDescription&&(t=encodeURIComponent(e[0].sharingDescription));var i=$("head title").text(),n="http://www.facebook.com/sharer.php?s=100&p[title]="+i+"&p[summary]="+t+"&p[url]="+document.location.href+"&p[images][0]=http:"+r;$(".facebook-lookbook").attr("href",n.replace(/\s/g,"%20").replace("#","%23"));var a=$(".currentPanel img").attr("src");a=a.split("lookbook/"),a=a[1],_gaq.push(["_trackEvent","Lookbook Social Sharing","Click - "+a,"Facebook"])}),$(".pinterest-lookbook").click(function(o){o.preventDefault();var r=$("head title").text()+"%20page%20"+currentLookBookID+"%20by%20TOAST";e.length>0&&void 0!=e[0].sharingDescription&&(r=encodeURIComponent(e[0].sharingDescription));var t=$(".currentPanel img").attr("src").replace(sizeRegex,"/250/"),i="//pinterest.com/pin/create/button/?url="+document.location.href+"&media="+t+"&description="+r;$(".pinterest-lookbook").attr("href",i.replace(/\s/g,"%20").replace("#","%23"));var n=$(".currentPanel img").attr("src");n=n.split("lookbook/"),n=n[1],_gaq.push(["_trackEvent","Lookbook Social Sharing","Click - "+n,"Pinterest"])}),$(".twitter-lookbook").click(function(o){o.preventDefault();var r=$("head title").text()+"%20page%20"+currentLookBookID+"%20by%20TOAST";e.length>0&&void 0!=e[0].sharingDescription&&(r=encodeURIComponent(e[0].sharingDescription));var t="//twitter.com/share?url="+document.location.href+"&text="+r;$(".twitter-lookbook").attr("href",t.replace(/\s/g,"%20").replace("#","%23"));var i=$(".currentPanel img").attr("src");i=i.split("lookbook/"),i=i[1],_gaq.push(["_trackEvent","Lookbook Social Sharing","Click - "+i,"Twitter"])}),$(".pinterest-lookbook").popupWindow({height:400,width:800,centerBrowser:1}),$(".facebook-lookbook, .twitter-lookbook").popupWindow({height:350,width:670,centerBrowser:1})),$("#jersey-outer-wrap").css("visibility","visible").hide().fadeIn(400),$(".jersey-buy-off").length>0&&$("#jersey-outer-wrap").css("visibility","visible").hide().fadeIn(400),$("#imgNames").length>0&&e&&0!=e.length){for(var o=0;o<e.length;o++){var s=e[o],c="grid-parent mobile-grid-100";c+="portrait"==s.orientation?" port-"+s.percentWidth:"landscape"==s.orientation?" land-"+s.percentWidth:" square-"+s.percentWidth,c+="right"==s.float?" float-right":"";var d=$('<div class="'+c+" grid-"+s.percentWidth+" tablet-grid-"+s.percentWidth+' mobile-grid-100 grid-parent"></div>'),u=s.products.length>0?" data-id='"+s.lookbookID+"'":"",p=$('<a class="catImagesJQLink"'+u+"></a>");if(s.products.length>0)var k=$(['<div class="lookbook-tile-content">','<span class="visual-shop-button">',"Shop","</span>",'<div class="plus">+</div>',"</div>"].join(""));else var k=$('<div class="lookbook-tile-content"><div class="plus">+</div></div>');$("#imgNames").append(d),k.attr("style","background-image:url("+s.imgThumbSrc+"); filter: progid:DXImageTransform.Microsoft.AlphaImageLoader( src='"+s.imgThumbSrc+"', sizingMethod='scale');"),d.append(p),p.append(k);var g=document.location.href,f=g.replace(".htm","-browse.htm");p.attr("href",f+"#"+(o+1)),s.clear&&d.after("<div class='clearfix'></div>")}($("[collection='jerseyAugust2014']").length>0||$("[collection='kinfolkSeptember2014']").length>0)&&($("#imgNames > div:eq(0), #imgNames > div:eq(1), #imgNames > div:eq(2)").wrapAll("<div style='position: relative' id='bannerHolder'/>"),$("#bannerHolder").prepend($("#banner")).append("<div class='clear'></div>"),$("#imgNames").on("click",".openBanner",function(){$("#banner").fadeIn(),$(".openBanner").hide()}),$("#imgNames").on("click","#closeBanner",function(o){o.stopPropagation(),Modernizr.mq("(max-width: 767px)")?($("#banner").hide(),$(".openBanner").fadeIn()):($("#banner").hide(),$(".openBanner").show())}),$("[collection='kinfolkSeptember2014']").length>0&&($("#bannerHolder").prepend($("#secondBanner")).append("<div class='clear'></div>"),$("#imgNames").on("click","#banner",function(o){"closeBanner"!=$(o.target).attr("id")&&($("#secondBanner").fadeIn(),$("#banner").hide())}),$("#imgNames").on("click","#closeSecondBanner",function(){Modernizr.mq("(max-width: 767px)")?($("#secondBanner").hide(),$(".openBanner").fadeIn()):($("#secondBanner").hide(),$(".openBanner").show())})))}if($(".jersey-buy-off").length>0){currentLookBookID=1;var s={};initialSetUp(),getLookbookProductInfo(getDataStr()),$("#jersey-outer-wrap").on("click",".panel img",function(){$(".jersey-buy-off").is(":visible")&&$("html, body").animate({scrollTop:$(".jersey-buy-off").offset().top},300)}),$("#jersey-outer-wrap").on("click",".ls-nav-right-arrow",function(){lookbookGoRight()}),$("#jersey-outer-wrap").on("click",".right-slider-overlay",function(){$(".ls-nav-right-arrow").trigger("click")}),$("#jersey-outer-wrap").on("click",".ls-nav-left-arrow",function(){lookbookGoLeft()}),$("#jersey-outer-wrap").on("click",".left-slider-overlay",function(){$(".ls-nav-left-arrow").trigger("click")}),$("#jersey-outer-wrap").on("click",".jersey-carousel-left",function(){$(".selected-range-product").prev(".range-product").length>0?$(".selected-range-product").prev(".range-product").trigger("click"):$(".range-product").last().trigger("click")}),$("#jersey-outer-wrap").on("click",".jersey-carousel-right",function(){$(".selected-range-product").next(".range-product").length>0?$(".selected-range-product").next(".range-product").trigger("click"):$(".range-product").first().trigger("click")}),$("#jersey-outer-wrap").on("click",".panel-wrapper",function(o){o.preventDefault(),$(".selected-range-product").trigger("click"),$(".jersey-buy-off, .buy-off-container").show(),$("html, body").animate({scrollTop:$(".jersey-buy-off").offset().top},300),rangeModule.toggleOpenDescription(),_gaq.push(["_trackEvent","Lookbook Shop Button","Click",$("#jersey-outer-wrap").attr("collection")+" image "+window.location.hash])}),$("#jersey-outer-wrap").on("click",".jersey-close",function(){$(".jersey-buy-off, .buy-off-container").hide(),$("#imgNames").length<1&&$("html, body").animate({scrollTop:$("#jersey-outer-wrap").offset().top},300)}),$(".jersey-buy-off").prepend("<img src='//toast-images.s3.amazonaws.com/content-images/development/jersey/OurJersey_Close.png' class='jersey-close' />")}$(".jersey-buy-off").length>0&&$("#slide-panel").liquidSlider({autoHeight:!1,onload:function(){$($(".panel-container .panel img")[1]).addClass("currentImage"),$("#slide-panel .panel").swipe({swipeLeft:function(){$(".ls-nav-right-arrow").trigger("click")},swipeRight:function(){$(".ls-nav-left-arrow").trigger("click")}}),setTimeout(function(){$(".lookbook-navigations").length>0&&$("html, body").animate({scrollTop:$(".lookbook-navigations").offset().top-10},0)},250)},callback:function(){!r.lookbookFoundItem||void 0!=$($(".liquid-slider div img")[currentLookBookID-1]).attr("src")&&""!=$($(".liquid-slider div img")[currentLookBookID-1]).attr("src")||$($(".liquid-slider div img")[currentLookBookID-1]).attr("src",r.lookbookFoundItem.imgSrc),!i||void 0!=$($(".liquid-slider div img")[currentLookBookID-2]).attr("src")&&""!=$($(".liquid-slider div img")[currentLookBookID-2]).attr("src")||$($(".liquid-slider div img")[currentLookBookID-2]).attr("src",i.imgSrc),!t||void 0!=$($(".liquid-slider div img")[currentLookBookID]).attr("src")&&""!=$($(".liquid-slider div img")[currentLookBookID]).attr("src")||$($(".liquid-slider div img")[currentLookBookID]).attr("src",t.imgSrc),!n||void 0!=$($(".liquid-slider div img")[currentLookBookID-3]).attr("src")&&""!=$($(".liquid-slider div img")[currentLookBookID-3]).attr("src")||$($(".liquid-slider div img")[currentLookBookID-3]).attr("src",n.imgSrc),!a||void 0!=$($(".liquid-slider div img")[currentLookBookID+1]).attr("src")&&""!=$($(".liquid-slider div img")[currentLookBookID+1]).attr("src")||$($(".liquid-slider div img")[currentLookBookID+1]).attr("src",a.imgSrc),$(".lookbook-loader").addClass("visuallyHidden")},swipe:!1,slideEaseDuration:750,heightEaseDuration:500,hoverArrows:!1,continuous:!1,useCSSMaxWidth:1,firstPanelToLoad:currentLookBookID})}),r}();